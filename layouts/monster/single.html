{{ define "main" }}
{{ $pet := .Params.pet_skills | default (slice) }}

<h1 class="d-title">{{ .Title }}</h1>

<p style="margin:8px 0; font-size:12px; opacity:.7;">
  DEBUG pet_skills type={{ printf "%T" $pet }} / len={{ len $pet }}
</p>

{{ with .Params.image }}
  {{ $img := strings.TrimPrefix "/" . }}
  <div class="d-hero">
    <img class="d-hero-img" src="{{ $img | relURL }}" alt="{{ $.Title }}">
  </div>
{{ end }}

<p class="d-line">
  名前：{{ .Title }}（{{ .Params.attack_type }}・{{ .Params.attack_range }}・{{ .Params.element }}）
</p>

<section class="d-block">
  <div class="d-level">
    <div class="d-level-row">
      {{ with .Params.level_shortcuts }}
        {{ range . }}
          <button class="d-btn" type="button" data-lv="{{ . }}">Lv {{ . }}</button>
        {{ end }}
      {{ else }}
        <button class="d-btn" type="button" data-lv="1">Lv 1</button>
        <button class="d-btn" type="button" data-lv="700">Lv 700</button>
      {{ end }}
    </div>

    <div class="d-level-row">
      <label class="d-input">
        Lv <input type="number" min="1" value="1">
      </label>
    </div>
  </div>
</section>

<section class="d-block">
  <h2 class="d-h2">ステータス</h2>

  <dl class="d-list">
    <div class="d-row"><dt>vit</dt><dd>{{ .Params.status.vit }}</dd></div>
    <div class="d-row"><dt>spd</dt><dd>{{ .Params.status.spd }}</dd></div>
    <div class="d-row"><dt>atk</dt><dd>{{ .Params.status.atk }}</dd></div>
    <div class="d-row"><dt>int</dt><dd>{{ .Params.status.int }}</dd></div>
    <div class="d-row"><dt>def</dt><dd>{{ .Params.status.def }}</dd></div>
    <div class="d-row"><dt>mdef</dt><dd>{{ .Params.status.mdef }}</dd></div>
    <div class="d-row"><dt>luk</dt><dd>{{ .Params.status.luk }}</dd></div>

    {{ with .Params.fixed_status.mov }}
      <div class="d-row"><dt>mov</dt><dd>{{ . }}</dd></div>
    {{ end }}
  </dl>
</section>

<section class="d-block">
  <h2 class="d-h2">報酬・捕獲</h2>

  <dl class="d-list">
    <div class="d-row"><dt>獲得経験値</dt><dd>{{ .Params.exp }}</dd></div>
    <div class="d-row"><dt>獲得ゴールド</dt><dd>{{ .Params.gold }}</dd></div>
    <div class="d-row"><dt>捕獲率</dt><dd>{{ .Params.capture_rate }}%</dd></div>
  </dl>
</section>

{{ with .Params.drops }}
<section class="d-block">
  <h2 class="d-h2">ドロップ</h2>
  <ul class="d-bullets">
    {{ range . }}
      <li>{{ . }}</li>
    {{ end }}
  </ul>
</section>
{{ end }}

{{ if gt (len $pet) 0 }}
<section class="d-block">
  <h2 class="d-h2">ペットスキル</h2>

  {{ $levels := slice 31 71 121 181 }}

  <dl class="d-list">
    {{ range $i, $ps := $pet }}
      <div class="d-row">
        <dt>Lv{{ index $levels $i }}</dt>
        <dd>
          {{ $out := slice }}

          {{ with index $ps "add" }}
            {{ range $k, $v := . }}
              {{ $out = $out | append (printf "%s+%v" $k $v) }}
            {{ end }}
          {{ end }}

          {{ with index $ps "mul" }}
            {{ range $k, $v := . }}
              {{ $out = $out | append (printf "%s×%v%%" $k (mul $v 100)) }}
            {{ end }}
          {{ end }}

          {{ with index $ps "final_mul" }}
            {{ range $k, $v := . }}
              {{ $out = $out | append (printf "%s×%v%%(最終)" $k (mul $v 100)) }}
            {{ end }}
          {{ end }}

          {{ delimit $out " / " }}
        </dd>
      </div>
    {{ end }}
  </dl>
</section>
{{ end }}

{{ with .Params.locations }}
<section class="d-block">
  <h2 class="d-h2">出現場所</h2>
  <p class="d-places">
    {{ range $i, $v := . }}{{ if $i }} / {{ end }}{{ $v }}{{ end }}
  </p>
</section>
{{ end }}

<p class="d-back">
  <a href="{{ .CurrentSection.RelPermalink }}">← モンスター一覧に戻る</a>
</p>
{{ end }}
